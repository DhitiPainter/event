<mat-toolbar color="primary">
  <span class="fill-remaining-space">Event Management Form</span>
  <button mat-raised-button color="secondary" (click)="goToList()">List</button>
</mat-toolbar>

<div class="container" *ngIf="!post; else forminfo" novalidate>
  <form [formGroup]="formGroup" (ngSubmit)="onSubmit()" class="form">
    <!-- title -->
    <mat-form-field class="form-element">
      <input matInput placeholder="Title" formControlName="title" />
      <mat-error
        *ngIf="
          !formGroup.controls['title'].valid &&
          formGroup.controls['title'].touched
        "
      >
        Enter valid title
      </mat-error>
    </mat-form-field>
    <!-- all day check -->
    <div class="form-element">
      <mat-checkbox formControlName="isAllDay" value="1">ALL Day</mat-checkbox>
    </div>
    <!-- start date -->
    <div *ngIf="formGroup.controls['isAllDay'].value; else startDatetime">
      <mat-form-field>
        <input
          matInput
          [ngxMatDatetimePicker]="startDate"
          placeholder="Start date"
          formControlName="startDate"
        />
        <mat-datepicker-toggle
          matSuffix
          [for]="startDate"
        ></mat-datepicker-toggle>
        <mat-datepicker #startDate></mat-datepicker>
      </mat-form-field>
    </div>
    <ng-template #startDatetime>
      <mat-form-field>
        <input
          matInput
          [ngxMatDatetimePicker]="startDate"
          placeholder="Start date"
          formControlName="startDate"
        />
        <mat-datepicker-toggle
          matSuffix
          [for]="startDate"
        ></mat-datepicker-toggle>
        <ngx-mat-datetime-picker #startDate></ngx-mat-datetime-picker>
      </mat-form-field>
    </ng-template>
    <!-- end date -->
    <div *ngIf="formGroup.controls['isAllDay'].value; else endDatetime">
      <mat-form-field>
        <input
          matInput
          [ngxMatDatetimePicker]="endDate"
          placeholder="Start date"
          formControlName="endDate"
        />
        <mat-datepicker-toggle
          matSuffix
          [for]="endDate"
        ></mat-datepicker-toggle>
        <mat-datepicker #endDate></mat-datepicker>
      </mat-form-field>
    </div>
    <ng-template #endDatetime>
      <mat-form-field>
        <input
          matInput
          [ngxMatDatetimePicker]="endDate"
          placeholder="End date"
          formControlName="endDate"
        />
        <mat-datepicker-toggle
          matSuffix
          [for]="endDate"
        ></mat-datepicker-toggle>
        <ngx-mat-datetime-picker #endDate></ngx-mat-datetime-picker>
      </mat-form-field>
    </ng-template>

    <!-- Event Details -->
    <div>Event Details</div>
    <!-- location -->
    <!-- <div class="autocomplete-container">
      <mat-google-maps-autocomplete
        (onAutocompleteSelected)="onAutocompleteSelected($event)"
        (onLocationSelected)="onLocationSelected($event)"
      >
      </mat-google-maps-autocomplete>
    </div> -->
    <app-map></app-map>
    <!-- email -->
    <mat-form-field class="form-element">
      <input matInput placeholder="Email address" formControlName="email" />
      <mat-error
        *ngIf="
          !formGroup.controls['email'].valid &&
          formGroup.controls['email'].touched
        "
      >
        {{ getErrorEmail(i) }}
      </mat-error>
    </mat-form-field>
    <!-- description -->
    <mat-form-field class="form-element">
      <textarea
        matInput
        placeholder="Description"
        matTextareaAutosize
        matAutosizeMinRows="2"
        matAutosizeMaxRows="5"
        formControlName="desc"
      ></textarea>
      <mat-error
        *ngIf="
          !formGroup.controls['desc'].valid &&
          formGroup.controls['desc'].touched
        "
      >
        Must be up to 100 characters.
      </mat-error>
    </mat-form-field>
    <button
      mat-raised-button
      color="primary"
      type="button"
      class="button"
      [disabled]="!formGroup.controls.email.value"
    >
      <span (click)="addGuest(); $event.preventDefault()"
        ><mat-icon>add</mat-icon>Guests</span
      >
    </button>
    <!-- guests -->
    <div *ngFor="let guest of getGuestsFormControls(); let i = index">
      <div class="row">
        <mat-form-field class="form-element guest">
          <input
            matInput
            type="text"
            placeholder="Guest name"
            [formControl]="guest"
          />
        </mat-form-field>
        <button mat-raised-button (click)="removeGuest(i)">
          <mat-icon>delete</mat-icon>
        </button>
      </div>
    </div>

    <div class="form-element">
      <button
        mat-raised-button
        color="primary"
        type="submit"
        class="button"
        [disabled]="!formGroup.valid"
      >
        Submit Form
      </button>
    </div>
  </form>
</div>
